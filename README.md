# üé¨ NeuroCards Bot

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ–∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å AI**

Telegram-–±–æ—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è **–Ω–µ–π—Ä–æ–∫–æ–Ω—Ç–µ–Ω—Ç–∞**: –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–æ—á–µ–∫ –∏ –∫–æ—Ä–æ—Ç–∫–∏—Ö Reels —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ API Kling AI (KIE). –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤ –∏ —Ä–æ—Ç–∞—Ü–∏–µ–π –ø—Ä–æ–∫—Å–∏.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–∫–ª—é—á–µ–≤—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–¶–µ–Ω–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è](#-—Ü–µ–Ω–Ω–æ—Å—Ç—å-—Ä–µ—à–µ–Ω–∏—è)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∞—à–±–æ—Ä–¥—ã](#-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–¥–∞—à–±–æ—Ä–¥—ã)
- [API –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#-api-–∏-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
- [–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ](#-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

---

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- **üé® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ù–µ–π—Ä–æ–∫–∞—Ä—Ç–æ—á–µ–∫** - —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–∏–¥–µ–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **üì± –°–æ–∑–¥–∞–Ω–∏–µ Reels** - –∫–æ—Ä–æ—Ç–∫–∏–µ –≤–∏—Ä—É—Å–Ω—ã–µ –≤–∏–¥–µ–æ —Å AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π
- **üéÅ –°–∏—Å—Ç–µ–º–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤** - 2 –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞, –∏—Å—Ç–æ—Ä–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π, —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
- **üìä –î–∞—à–±–æ—Ä–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **üîÑ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –±–æ—Ç –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- **üé≠ Smart Prompting** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ —á–µ—Ä–µ–∑ GPT-4

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **üî• Hot Proxy Rotation** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞—Ö
- **‚öôÔ∏è Multi-Worker Architecture** - –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∑–∞–¥–∞—á
- **üóÑÔ∏è PostgreSQL + Redis** - –Ω–∞–¥—ë–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á
- **üê≥ Docker-Ready** - –ø–æ–ª–Ω–∞—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è, —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
- **üì¶ Flexible Storage** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ –æ–±–ª–∞—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- **üõ°Ô∏è Error Recovery** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry —Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –æ—à–∏–±–æ–∫
- **üîê Webhook Security** - –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ webhook'–∏ —Å secret token
- **üìà Health Checks** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## üíé –¶–µ–Ω–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏—è

### –î–ª—è –±–∏–∑–Ω–µ—Å–∞

1. **–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è AI-–∫–æ–Ω—Ç–µ–Ω—Ç–∞** - –ø—Ä–æ–¥–∞–∂–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ Telegram
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –æ—Ç MVP –¥–æ enterprise –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
3. **–ù–∏–∑–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è 99% –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
4. **–ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫** - –æ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ –ø–µ—Ä–≤–æ–π –ø—Ä–æ–¥–∞–∂–∏ –∑–∞ 15 –º–∏–Ω—É—Ç

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ –≤ 3 –∫–ª–∏–∫–∞
2. **–ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ 3-5 –º–∏–Ω—É—Ç
3. **–í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ** - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π AI-–∫–æ–Ω—Ç–µ–Ω—Ç
4. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å 24/7** - –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –≤—ã—Ö–æ–¥–Ω—ã—Ö

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

1. **–ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è
2. **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
3. **Best Practices** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ Python/Async
4. **Ready-to-Fork** - –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      TELEGRAM USERS                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   TELEGRAM BOT                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ  Webhook     ‚îÇ  ‚îÇ   Polling    ‚îÇ  ‚îÇ   Handlers   ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ  (Webhook)   ‚îÇ  ‚îÇ   (Backup)   ‚îÇ  ‚îÇ   (FSM)      ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      REDIS QUEUE                             ‚îÇ
‚îÇ            (RQ - Python Redis Queue)                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   WORKER POOL                                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îÇ
‚îÇ  ‚îÇ Worker1 ‚îÇ  ‚îÇ Worker2 ‚îÇ  ‚îÇ Worker3 ‚îÇ  ‚îÇ Worker N‚îÇ       ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ            ‚îÇ            ‚îÇ
          ‚ñº            ‚ñº            ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ KIE API ‚îÇ  ‚îÇ OpenAI  ‚îÇ  ‚îÇ  File   ‚îÇ
    ‚îÇ (Video) ‚îÇ  ‚îÇ (GPT-4) ‚îÇ  ‚îÇ Storage ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ            ‚îÇ            ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚ñº
               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
               ‚îÇ  PostgreSQL  ‚îÇ
               ‚îÇ  (Database)  ‚îÇ
               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. **Bot Layer** (`app/`)
- **Handlers** - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ callback'–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **FSM States** - –º–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **Keyboards** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã Telegram
- **Proxy Rotator** - –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏

#### 2. **Worker Layer** (`worker/`)
- **Job Processor** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á –∏–∑ Redis Queue
- **KIE Client** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kling AI API
- **OpenAI Prompter** - —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ —á–µ—Ä–µ–∑ GPT
- **Error Classifier** - —É–º–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫
- **Key Rotator** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è API –∫–ª—é—á–µ–π

#### 3. **Storage Layer**
- **PostgreSQL** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫—Ä–µ–¥–∏—Ç—ã, –∑–∞–¥–∞—á–∏
- **Redis** - –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **File Storage** - –ª–æ–∫–∞–ª—å–Ω–æ–µ –∏–ª–∏ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞

#### 4. **Integration Layer**
- **Kling AI (KIE)** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ
- **OpenAI GPT-4** - —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
- **Telegram Bot API** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

---

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend
- **Python 3.11+** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Python
- **aiogram 3.x** - async Telegram Bot framework
- **asyncpg** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π PostgreSQL –¥—Ä–∞–π–≤–µ—Ä
- **Redis Queue (RQ)** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
- **httpx** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã

### Infrastructure
- **Docker & Docker Compose** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **PostgreSQL 15** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Redis 7** - –∫–µ—à –∏ –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á
- **Nginx** - reverse proxy (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### AI & API
- **Kling AI (KIE)** - image-to-video –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- **OpenAI GPT-4** - prompt engineering
- **aiohttp-socks** - –ø—Ä–æ–∫—Å–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker 20.10+
- Docker Compose 2.0+
- API –∫–ª—é—á–∏: Telegram Bot, Kling AI, OpenAI

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/kirbudilov01/neurocards-bot.git
cd neurocards-bot
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp .env.example .env
nano .env
```

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (`.env`):

```env
# Telegram Bot
BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11

# PostgreSQL
POSTGRES_PASSWORD=secure_password_here

# AI APIs
KIE_API_KEY=key1,key2,key3,key4,key5
OPENAI_API_KEY=sk-...

# Workers
WORKER_REPLICAS=5
```

### 3. –ó–∞–ø—É—Å–∫

```bash
docker-compose up -d
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
docker-compose logs -f neurocards-polling
docker-compose logs -f neurocards-worker-1
```

### 5. –¢–µ—Å—Ç

–û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É –≤ Telegram!

### ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–∏–¥–µ–æ

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–æ—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç welcome-–≤–∏–¥–µ–æ —Å –¥–∏—Å–∫–∞ (–º–µ–¥–ª–µ–Ω–Ω–æ ~60s). –î–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ cached file_id:

#### –°–ø–æ—Å–æ–± 1: Auto-caching (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ü–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç welcome –≤–∏–¥–µ–æ (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ)
2. –í –ª–æ–≥–∞—Ö —É–≤–∏–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
   ```
   ‚ö†Ô∏è SAVE THIS file_id to .env and restart:
      WELCOME_VIDEO_FILE_ID=AgACAgIAAxkBAAICXGXxx...
   ```

3. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
   ```env
   WELCOME_VIDEO_FILE_ID=AgACAgIAAxkBAAICXGXxx...
   ```

4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç:
   ```bash
   docker-compose restart neurocards-polling
   ```

–¢–µ–ø–µ—Ä—å welcome-–≤–∏–¥–µ–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ** (0.5s –≤–º–µ—Å—Ç–æ 60s).

#### –°–ø–æ—Å–æ–± 2: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º file_id –∑–∞—Ä–∞–Ω–µ–µ

```bash
python3 -c "
import asyncio
from aiogram import Bot
from aiogram.types import FSInputFile

async def get_file_id():
    bot = Bot(token='–í–ê–®_BOT_TOKEN')
    video_file = FSInputFile('/app/assets/welcome.mp4')
    msg = await bot.send_video(ADMIN_USER_ID, video=video_file)
    print(f'WELCOME_VIDEO_FILE_ID={msg.video.file_id}')

asyncio.run(get_file_id())
"
```

#### –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ

–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ **—Ç–∞–∫–∂–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è**:
- –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è `video_file_id`
- –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ (–∫–Ω–æ–ø–∫–∞ "–°–¥–µ–ª–∞—Ç—å –µ—â—ë") –≤–∏–¥–µ–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∏–∑ –∫—ç—à–∞ Telegram
- –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ `worker/worker.py`

---

## üåê –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ –ë–î
docker-compose up -d postgres redis

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ (polling)
python -m app.main_polling

# –ó–∞–ø—É—Å–∫ –≤–æ—Ä–∫–µ—Ä–∞
python -m worker.rq_worker
```

### Production (VPS/Cloud)

–°–º. –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ [DEPLOY.md](DEPLOY.md)

**–ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ VPS:**

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@your-server-ip

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com | sh

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
git clone https://github.com/kirbudilov01/neurocards-bot.git
cd neurocards-bot
cp .env.example .env
nano .env

# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–æ–≤
docker-compose up --scale neurocards-worker=20 -d
```

### Webhook —Ä–µ–∂–∏–º

```bash
# .env
PUBLIC_BASE_URL=https://your-domain.com
WEBHOOK_SECRET_TOKEN=random_secret_token

# docker-compose.yml - —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å bot service
docker-compose up -d bot
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∞—à–±–æ—Ä–¥—ã

### –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∞–¥–º–∏–Ω –¥–∞—à–±–æ—Ä–¥

–ë–æ—Ç –≤–∫–ª—é—á–∞–µ—Ç **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–Ω–µ–ª—å** –ø—Ä—è–º–æ –≤ Telegram:

```
/admin (–¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
```

**–ú–µ—Ç—Ä–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:**
- üë• –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üé¨ –í—Å–µ–≥–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤–∏–¥–µ–æ
- ‚è±Ô∏è –ó–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥–∏
- üîÑ –ê–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
- üí∞ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤
- üìà –ì—Ä–∞—Ñ–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Health Checks

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–æ—Ç–∞
curl http://localhost:8080/healthz

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
docker exec neurocards-postgres pg_isready

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Redis
docker exec neurocards-redis redis-cli ping

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—á–µ—Ä–µ–¥–∏
docker exec neurocards-redis redis-cli llen rq:queue:default
```

### –õ–æ–≥–∏

```bash
# –ë–æ—Ç
docker logs neurocards-polling -f --tail 100

# –í–æ—Ä–∫–µ—Ä—ã
docker logs neurocards-worker-1 -f --tail 100

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
docker logs neurocards-postgres -f --tail 100

# Redis
docker logs neurocards-redis -f --tail 100
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–¥–∞—á

```bash
# –ß–µ—Ä–µ–∑ Redis CLI
docker exec -it neurocards-redis redis-cli

# –ö–æ–º–∞–Ω–¥—ã –≤ Redis:
> LLEN rq:queue:default          # –ó–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥–∏
> SMEMBERS rq:workers            # –°–ø–∏—Å–æ–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤
> HGETALL rq:job:job_id          # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞—á–µ
> KEYS rq:job:*                  # –í—Å–µ –∑–∞–¥–∞—á–∏
```

---

## üîå API –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### Telegram Bot API

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- `/start` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/menu` - –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/cabinet` - –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
- `/cancel` - –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ

**Callback patterns:**
- `generate_neurocard` - —Å–æ–∑–¥–∞—Ç—å –Ω–µ–π—Ä–æ–∫–∞—Ä—Ç–æ—á–∫—É
- `generate_reels` - —Å–æ–∑–¥–∞—Ç—å Reels
- `again:{type}` - –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
- `back_to_menu` - –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

### Kling AI (KIE) API

```python
# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
POST https://api.klingai.com/v1/videos/image2video
{
    "model_name": "kling-v1",
    "image_url": "https://...",
    "prompt": "camera move forward...",
    "duration": "5"
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
GET https://api.klingai.com/v1/videos/image2video/{task_id}
```

### OpenAI GPT-4

```python
# –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞
messages = [
    {"role": "system", "content": SYSTEM_PROMPT},
    {"role": "user", "content": user_prompt}
]
response = openai.ChatCompletion.create(
    model="gpt-4-turbo-preview",
    messages=messages
)
```

### Database Schema

```sql
-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
CREATE TABLE users (
    tg_id BIGINT PRIMARY KEY,
    username TEXT,
    full_name TEXT,
    credits INTEGER DEFAULT 0,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- –ó–∞–¥–∞—á–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
CREATE TABLE generation_jobs (
    job_id TEXT PRIMARY KEY,
    tg_id BIGINT REFERENCES users(tg_id),
    type TEXT, -- 'neurocard' or 'reels'
    status TEXT, -- 'queued', 'processing', 'completed', 'failed'
    prompt TEXT,
    input_path TEXT,
    output_path TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    completed_at TIMESTAMPTZ
);
```

---

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–æ–≤

```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 50 –≤–æ—Ä–∫–µ—Ä–æ–≤
docker-compose up --scale neurocards-worker=50 -d

# –ò–ª–∏ –≤ docker-compose.yml
services:
  neurocards-worker:
    deploy:
      replicas: 50
```

### –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

```yaml
# docker-compose.yml
services:
  neurocards-worker:
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 4G
        reservations:
          cpus: '1'
          memory: 2G
```

### –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

```nginx
# nginx.conf
upstream bot_backend {
    least_conn;
    server bot1:8080;
    server bot2:8080;
    server bot3:8080;
}
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```yaml
# –†–µ–ø–ª–∏–∫–∞—Ü–∏—è PostgreSQL
postgres-primary:
  image: postgres:15-alpine
  environment:
    POSTGRES_REPLICATION_MODE: master

postgres-replica:
  image: postgres:15-alpine
  environment:
    POSTGRES_REPLICATION_MODE: slave
    POSTGRES_MASTER_HOST: postgres-primary
```

### Redis Cluster

```yaml
# –î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
redis-cluster:
  image: redis:7-alpine
  command: redis-cli --cluster create node1:6379 node2:6379 node3:6379
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### Telegram
```env
BOT_TOKEN=                    # Bot token –æ—Ç @BotFather
PUBLIC_BASE_URL=              # URL –¥–ª—è webhook (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
WEBHOOK_SECRET_TOKEN=         # –°–µ–∫—Ä–µ—Ç –¥–ª—è webhook (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

#### Database
```env
DATABASE_TYPE=postgres        # –¢–∏–ø –ë–î (postgres)
DATABASE_URL=                 # PostgreSQL connection string
POSTGRES_USER=neurocards      # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î
POSTGRES_PASSWORD=            # –ü–∞—Ä–æ–ª—å –ë–î (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)
```

#### Redis
```env
REDIS_URL=redis://redis:6379/0  # URL Redis —Å–µ—Ä–≤–µ—Ä–∞
```

#### Storage
```env
STORAGE_TYPE=local            # local –∏–ª–∏ cloud
STORAGE_BASE_PATH=/app/storage  # –ü—É—Ç—å –¥–ª—è —Ñ–∞–π–ª–æ–≤
```

#### AI APIs
```env
KIE_API_KEY=key1,key2,key3    # Kling AI –∫–ª—é—á–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
OPENAI_API_KEY=sk-...         # OpenAI API –∫–ª—é—á
```

#### Workers
```env
WORKER_REPLICAS=5             # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤
WORKER_TIMEOUT=1800           # –¢–∞–π–º–∞—É—Ç –∑–∞–¥–∞—á–∏ (—Å–µ–∫—É–Ω–¥—ã)
```

#### Proxy
```env
PROXY_FILE=/app/proxies.txt   # –§–∞–π–ª —Å –ø—Ä–æ–∫—Å–∏
PROXY_COOLDOWN=300            # Cooldown –ø–æ—Å–ª–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (—Å–µ–∫)
```

### –ü—Ä–æ–∫—Å–∏ —Ñ–æ—Ä–º–∞—Ç

**–§–æ—Ä–º–∞—Ç –≤ `proxies.txt`:**
```
ip:port:username:password
192.168.1.1:8080:user1:pass1
10.0.0.1:3128:user2:pass2
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ:**
- CPU: 2 core
- RAM: 2 GB
- Disk: 20 GB
- Network: 100 Mbps

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ:**
- CPU: 4+ cores
- RAM: 8+ GB
- Disk: 100+ GB SSD
- Network: 1 Gbps

**–ù–∞ 100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π:**
- CPU: 8+ cores
- RAM: 16+ GB
- Disk: 500+ GB SSD
- Workers: 20-50

---

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
neurocards-bot/
‚îú‚îÄ‚îÄ app/                      # Telegram Bot
‚îÇ   ‚îú‚îÄ‚îÄ handlers/            # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ services/            # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ db_adapter.py        # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py         # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ states.py            # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ texts.py             # –¢–µ–∫—Å—Ç–æ–≤–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ proxy_rotator.py     # –†–æ—Ç–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏
‚îú‚îÄ‚îÄ worker/                   # Background Workers
‚îÇ   ‚îú‚îÄ‚îÄ worker.py            # –ì–ª–∞–≤–Ω—ã–π –≤–æ—Ä–∫–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ kie_client.py        # Kling AI –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ openai_prompter.py   # GPT –ø—Ä–æ–º–ø—Ç–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ kie_key_rotator.py   # –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ kie_error_classifier.py  # –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ scripts/                  # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ deploy_to_vps.sh     # –î–µ–ø–ª–æ–π —Å–∫—Ä–∏–ø—Ç
‚îÇ   ‚îú‚îÄ‚îÄ backup_vps.sh        # –ë—ç–∫–∞–ø
‚îÇ   ‚îî‚îÄ‚îÄ cleanup_stuck_jobs.py  # –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–∏—Å—à–∏—Ö –∑–∞–¥–∞—á
‚îú‚îÄ‚îÄ tests/                    # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ docker-compose.yml        # Docker –∫–æ–º–ø–æ–∑–∏—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile.bot           # Bot –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ Dockerfile.worker        # Worker –æ–±—Ä–∞–∑
‚îî‚îÄ‚îÄ requirements.txt         # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

1. –°–æ–∑–¥–∞—Ç—å handler –≤ `app/handlers/flow_newtype.py`
2. –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ `app/states.py`
3. –°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–¥–∞—á–∏ –≤ `worker/worker.py`
4. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –≤ `app/keyboards.py`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# Unit —Ç–µ—Å—Ç—ã
pytest tests/test_generation.py

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/test_atomicity.py

# –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
python test_full_system.py

# –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–∏–¥–µ–æ
python test_send_video.py
```

---

## üì¶ –°–∫–∞—á–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å

### –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ü–æ–ª–Ω—ã–π –∞—Ä—Ö–∏–≤ (—Å .git)
tar -czf neurocards-bot-full.tar.gz neurocards-bot/

# –ë–µ–∑ git –∏—Å—Ç–æ—Ä–∏–∏ (–ª–µ–≥—á–µ)
tar -czf neurocards-bot.tar.gz \
    --exclude='.git' \
    --exclude='__pycache__' \
    --exclude='*.pyc' \
    --exclude='.env' \
    --exclude='storage' \
    neurocards-bot/
```

### –ü—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

**GitHub Release:**
```bash
gh release create v1.0.0 \
    neurocards-bot.tar.gz \
    --title "NeuroCards Bot v1.0.0" \
    --notes "Production ready release"
```

**Transfer.sh (–≤—Ä–µ–º–µ–Ω–Ω—ã–π):**
```bash
curl --upload-file neurocards-bot.tar.gz https://transfer.sh/neurocards-bot.tar.gz
# –ü–æ–ª—É—á–∏—Ç–µ —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
```

**Google Drive / Dropbox:**
```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ CLI
rclone copy neurocards-bot.tar.gz gdrive:Projects/
```

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Telegram:** [@fabricbothelper](https://t.me/fabricbothelper)
- **Email:** support@neurocards.bot
- **GitHub Issues:** [github.com/kirbudilov01/neurocards-bot/issues](https://github.com/kirbudilov01/neurocards-bot/issues)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. [LICENSE](LICENSE)

---

## üéØ Roadmap

- [ ] –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- [ ] –ü–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã (–Æ–ö–∞—Å—Å–∞, Stripe)
- [ ] –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (web)
- [ ] Statsd/Prometheus –º–µ—Ç—Ä–∏–∫–∏
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ (>20MB)
- [ ] Multi-—è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- [ ] API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- [ ] Mobile app

---

## üåü –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–°–ø–∞—Å–∏–±–æ —Å–æ–æ–±—â–µ—Å—Ç–≤—É –∑–∞ –≤–∫–ª–∞–¥ –≤ —Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞!

- [aiogram](https://github.com/aiogram/aiogram) - –º–æ—â–Ω—ã–π async Telegram framework
- [Redis Queue](https://python-rq.org/) - –ø—Ä–æ—Å—Ç–∞—è –∏ –Ω–∞–¥—ë–∂–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á
- [Kling AI](https://klingai.com/) - —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ

---

**Made with ‚ù§Ô∏è and ‚òï by [kirbudilov01](https://github.com/kirbudilov01)**

**Star ‚≠ê this repo if you find it useful!**
