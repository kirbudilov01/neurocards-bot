# ๐๏ธ Scripts ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฑะพัะพะผ

ะะฐะฑะพั ัะบัะธะฟัะพะฒ ะดะปั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ ะดะตะฟะปะพั, ะพะฑะฝะพะฒะปะตะฝะธั ะธ ะผะพะฝะธัะพัะธะฝะณะฐ ะฑะพัะฐ ะฝะฐ VPS.

## ๐ ะะพัััะฟะฝัะต ัะบัะธะฟัั

### ๐ deploy_to_vps.sh - ะะฒัะพะผะฐัะธัะตัะบะธะน ะดะตะฟะปะพะน

ะะพะปะฝะพัััั ะฐะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝะฝัะน ะดะตะฟะปะพะน ะฑะพัะฐ ะฝะฐ ัะธัััะน VPS ัะตัะฒะตั.

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
```bash
./scripts/deploy_to_vps.sh YOUR_SERVER_IP
```

**ะงัะพ ะดะตะปะฐะตั:**
- โ ะะฑะฝะพะฒะปัะตั ัะธััะตะผั
- โ ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั Python 3.11, PostgreSQL, Nginx
- โ ะะฐัััะฐะธะฒะฐะตั firewall (ufw)
- โ ะกะพะทะดะฐะตั ะฑะฐะทั ะดะฐะฝะฝัั ั ััะตะผะพะน
- โ ะะปะพะฝะธััะตั ัะตะฟะพะทะธัะพัะธะน
- โ ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั ะทะฐะฒะธัะธะผะพััะธ
- โ ะะฐัััะฐะธะฒะฐะตั systemd ัะตัะฒะธัั
- โ ะะฐะฟััะบะฐะตั ะฑะพัะฐ ะธ worker

**ะขัะตะฑัะตััั:**
- ะงะธัััะน VPS ั Ubuntu 22.04/24.04
- SSH ะดะพัััะฟ (root)
- API ะบะปััะธ (BOT_TOKEN, KIE_API_KEY, OPENAI_API_KEY)

โฑ๏ธ **ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั:** 5-10 ะผะธะฝัั

---

### ๐ update_vps.sh - ะะฑะฝะพะฒะปะตะฝะธะต ะฑะพัะฐ

ะะฑะฝะพะฒะปัะตั ะบะพะด ะฑะพัะฐ ะฝะฐ ัะตัะฒะตัะต ะดะพ ะฟะพัะปะตะดะฝะตะน ะฒะตััะธะธ ะธะท GitHub.

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
```bash
./scripts/update_vps.sh YOUR_SERVER_IP
```

**ะงัะพ ะดะตะปะฐะตั:**
- โ ะะพะปััะฐะตั ะฟะพัะปะตะดะฝะธะต ะธะทะผะตะฝะตะฝะธั (git pull)
- โ ะะฑะฝะพะฒะปัะตั ะทะฐะฒะธัะธะผะพััะธ (pip install)
- โ ะะตัะตะทะฐะฟััะบะฐะตั ัะตัะฒะธัั
- โ ะะพะบะฐะทัะฒะฐะตั ััะฐััั ะฟะพัะปะต ะพะฑะฝะพะฒะปะตะฝะธั

**Workflow:**
```bash
# 1. ะะพะบะฐะปัะฝะพ ะดะตะปะฐะตัั ะธะทะผะตะฝะตะฝะธั
git add .
git commit -m "Update"
git push

# 2. ะะฑะฝะพะฒะปัะตัั ะฝะฐ ัะตัะฒะตัะต
./scripts/update_vps.sh YOUR_SERVER_IP
```

โฑ๏ธ **ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั:** 1-2 ะผะธะฝััั

---

### ๐ monitor_vps.sh - ะะพะฝะธัะพัะธะฝะณ ัะพััะพัะฝะธั

ะะพะบะฐะทัะฒะฐะตั ะฟะพะปะฝัั ะธะฝัะพัะผะฐัะธั ะพ ัะพััะพัะฝะธะธ ะฑะพัะฐ ะธ ัะตัะฒะตัะฐ.

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
```bash
./scripts/monitor_vps.sh YOUR_SERVER_IP
```

**ะะพะบะฐะทัะฒะฐะตั:**
- ๐ ะกัะฐััั ัะตัะฒะธัะพะฒ (bot, workers, PostgreSQL, Nginx)
- ๐พ ะกัะฐัะธััะธะบะฐ ะะ (ะฟะพะปัะทะพะฒะฐัะตะปะธ, ะทะฐะดะฐะฝะธั, ะพัะตัะตะดั)
- ๐ค ะะพัะปะตะดะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปะธ
- ๐ ะะพัะปะตะดะฝะธะต ะทะฐะดะฐะฝะธั
- ๐ป ะกะธััะตะผะฝัะต ัะตััััั (CPU, RAM, ะดะธัะบ)
- ๐ ะกัะฐัะธััะธะบะฐ ััะฐะฝะธะปะธัะฐ ัะฐะนะปะพะฒ
- ๐ ะะพัะปะตะดะฝะธะต ะทะฐะฟะธัะธ ะฒ ะปะพะณะฐั

**ะัะธะผะตั ะฒัะฒะพะดะฐ:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
     ๐ค Neurocards Bot - ะะพะฝะธัะพัะธะฝะณ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ ะกัะฐััั ัะตัะฒะธัะพะฒ:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Bot:        Running
โ Workers:    Running (3 instances)
โ PostgreSQL: Running
โ Nginx:      Running

๐พ ะะฐะทะฐ ะดะฐะฝะฝัั:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ฅ ะะพะปัะทะพะฒะฐัะตะปะตะน:         142
๐ฆ ะัะตะณะพ ะทะฐะดะฐะฝะธะน:         567
โณ ะ ะพัะตัะตะดะธ:             3
โ๏ธ  ะะฑัะฐะฑะฐััะฒะฐะตััั:        2
โ ะัะฟะพะปะฝะตะฝะพ:             550
โ ะัะธะฑะพะบ:                12

๐ป ะกะธััะตะผะฝัะต ัะตััััั:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ฅ CPU:     23.4%
๐ง RAM:     45%
๐พ Disk:    28%
๐ Load:    0.85, 0.92, 1.01
```

โฑ๏ธ **ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั:** ะฝะตัะบะพะปัะบะพ ัะตะบัะฝะด

---

### ๐พ backup_vps.sh - ะัะบะฐะฟ ะดะฐะฝะฝัั

ะกะพะทะดะฐะตั ัะตะทะตัะฒะฝัั ะบะพะฟะธั ะฑะฐะทั ะดะฐะฝะฝัั ะธ ัะฐะนะปะพะฒ ั ัะตัะฒะตัะฐ.

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
```bash
./scripts/backup_vps.sh YOUR_SERVER_IP [local_backup_dir]

# ะะพ ัะผะพะปัะฐะฝะธั ัะพััะฐะฝัะตั ะฒ ./backups
./scripts/backup_vps.sh YOUR_SERVER_IP

# ะะพะถะฝะพ ัะบะฐะทะฐัั ัะฒะพั ะดะธัะตะบัะพัะธั
./scripts/backup_vps.sh YOUR_SERVER_IP /path/to/backups
```

**ะงัะพ ัะพััะฐะฝัะตั:**
- ๐ ะะฐะทะฐ ะดะฐะฝะฝัั (PostgreSQL dump)
- ๐ ะคะฐะนะปั ััะฐะฝะธะปะธัะฐ (/var/neurocards/storage)
- โ๏ธ ะะพะฝัะธะณััะฐัะธั (.env ัะฐะนะป)

**ะะตะทัะปััะฐั:**
```
backups/
โโโ db_20260118_143052.sql.gz         # ะะฐะทะฐ ะดะฐะฝะฝัั
โโโ storage_20260118_143052.tar.gz    # ะคะฐะนะปั
โโโ env_20260118_143052.txt           # ะะพะฝัะธะณััะฐัะธั
```

**ะะตะบะพะผะตะฝะดะฐัะธั:** ะทะฐะฟััะบะฐะน ัะตะณัะปััะฝะพ, ะพัะพะฑะตะฝะฝะพ ะฟะตัะตะด ะพะฑะฝะพะฒะปะตะฝะธัะผะธ!

โฑ๏ธ **ะัะตะผั ะฒัะฟะพะปะฝะตะฝะธั:** ะทะฐะฒะธัะธั ะพั ัะฐะทะผะตัะฐ ะดะฐะฝะฝัั (ะพะฑััะฝะพ 1-5 ะผะธะฝัั)

---

### ๐งช local_run.sh - ะะพะบะฐะปัะฝัะน ะทะฐะฟััะบ (ะดะปั ัะฐะทัะฐะฑะพัะบะธ)

ะะฐะฟััะบะฐะตั ะฑะพัะฐ ะธ worker ะปะพะบะฐะปัะฝะพ ะดะปั ัะตััะธัะพะฒะฐะฝะธั.

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต:**
```bash
./scripts/local_run.sh
```

ะัะฟะพะปัะทัะตััั ัะพะปัะบะพ ะดะปั ัะฐะทัะฐะฑะพัะบะธ ะฝะฐ ะปะพะบะฐะปัะฝะพะน ะผะฐัะธะฝะต.

---

## ๐ ะขัะตะฑะพะฒะฐะฝะธั ะดะปั ัะบัะธะฟัะพะฒ

### SSH ะดะพัััะฟ

ะกะบัะธะฟัั ะฟะพะดะบะปััะฐัััั ะบ ัะตัะฒะตัั ะฟะพ SSH. ะฃะฑะตะดะธัั ััะพ:

1. **ะฃ ัะตะฑั ะตััั SSH ะบะปัั:**
```bash
# ะัะพะฒะตัะบะฐ
ls ~/.ssh/id_rsa.pub

# ะกะพะทะดะฐะฝะธะต (ะตัะปะธ ะฝะตั)
ssh-keygen -t rsa -b 4096
```

2. **ะะปัั ะดะพะฑะฐะฒะปะตะฝ ะฝะฐ ัะตัะฒะตั:**
```bash
# ะะพะฟะธััะตะผ ะบะปัั ะฝะฐ ัะตัะฒะตั
ssh-copy-id root@YOUR_SERVER_IP

# ะัะพะฒะตััะตะผ ะฟะพะดะบะปััะตะฝะธะต
ssh root@YOUR_SERVER_IP "echo 'Connection OK'"
```

3. **ะกะตัะฒะตั ะดะพัััะฟะตะฝ ะฟะพ SSH:**
```bash
# ะัะพะฒะตััะตะผ ััะพ ะฟะพัั 22 ะพัะบััั
nc -zv YOUR_SERVER_IP 22
```

---

## ๐ ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะะตัะฒัะน ะดะตะฟะปะพะน

```bash
# 1. ะกะพะทะดะฐะตะผ VPS ะฝะฐ Hetzner/DigitalOcean
# 2. ะะพะปััะฐะตะผ IP ะฐะดัะตั
# 3. ะะฐะฟััะบะฐะตะผ ะดะตะฟะปะพะน
./scripts/deploy_to_vps.sh 123.45.67.89

# 4. ะะฐัััะฐะธะฒะฐะตะผ webhook
curl -X POST "https://api.telegram.org/bot<TOKEN>/setWebhook" \
  -d "url=https://123.45.67.89:8443/webhook"

# 5. ะขะตััะธััะตะผ ะฑะพัะฐ ะฒ Telegram
```

### ะะถะตะดะฝะตะฒะฝะฐั ัะฐะฑะพัะฐ

```bash
# ะฃััะพ - ะฟัะพะฒะตััะตะผ ัะพััะพัะฝะธะต
./scripts/monitor_vps.sh 123.45.67.89

# ะะฝะพัะธะผ ะธะทะผะตะฝะตะฝะธั ะฒ ะบะพะด
git add .
git commit -m "Fix bug"
git push

# ะะฑะฝะพะฒะปัะตะผ ะฝะฐ ัะตัะฒะตัะต
./scripts/update_vps.sh 123.45.67.89

# ะัะพะฒะตััะตะผ ััะพ ะฒัะต ัะฐะฑะพัะฐะตั
./scripts/monitor_vps.sh 123.45.67.89
```

### ะะถะตะฝะตะดะตะปัะฝัะน ะฑัะบะฐะฟ

```bash
# ะะพัะบัะตัะตะฝัะต - ะดะตะปะฐะตะผ ะฑัะบะฐะฟ
./scripts/backup_vps.sh 123.45.67.89 /backup/neurocards

# ะัะพะฒะตััะตะผ ัะฐะทะผะตัั
ls -lh /backup/neurocards/
```

### ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต ะดะปั ะฒััะพะบะพะน ะฝะฐะณััะทะบะธ

```bash
# ะกะผะพััะธะผ ัะตะบัััั ะฝะฐะณััะทะบั
./scripts/monitor_vps.sh 123.45.67.89

# ะัะปะธ ะผะฝะพะณะพ ะทะฐะดะฐั ะฒ ะพัะตัะตะดะธ - ะดะพะฑะฐะฒะปัะตะผ worker'ะพะฒ
ssh root@123.45.67.89
systemctl enable neurocards-worker@{2..5}
systemctl start neurocards-worker@{2..5}

# ะัะพะฒะตััะตะผ
./scripts/monitor_vps.sh 123.45.67.89
# ะะพะปะถะฝะพ ะฟะพะบะฐะทะฐัั "Workers: Running (5 instances)"
```

---

## ๐ Troubleshooting

### ะกะบัะธะฟั ะฝะต ะทะฐะฟััะบะฐะตััั

```bash
# ะัะพะฒะตัั ะฟัะฐะฒะฐ ะฝะฐ ะฒัะฟะพะปะฝะตะฝะธะต
ls -la scripts/*.sh

# ะัะปะธ ะฝะตั ะฟัะฐะฒ - ะดะพะฑะฐะฒั
chmod +x scripts/*.sh
```

### SSH ะฟะพะดะบะปััะตะฝะธะต ะฝะต ัะฐะฑะพัะฐะตั

```bash
# ะัะพะฒะตัั ััะพ ัะตัะฒะตั ะดะพัััะฟะตะฝ
ping YOUR_SERVER_IP

# ะัะพะฒะตัั SSH ะฟะพัั
nc -zv YOUR_SERVER_IP 22

# ะะพะฟัะพะฑัะน ะฟะพะดะบะปััะธัััั ะฒัััะฝัั
ssh root@YOUR_SERVER_IP
```

### ะะตะฟะปะพะน ะฟะฐะดะฐะตั ั ะพัะธะฑะบะพะน

```bash
# ะัะพะฒะตัั ะปะพะณะธ ะฝะฐ ัะตัะฒะตัะต
ssh root@YOUR_SERVER_IP
journalctl -xe

# ะัะพะฒะตัั ะดะพัััะฟะฝะพััั ะฟะพััะพะฒ
ufw status

# ะัะพะฒะตัั ัะฒะพะฑะพะดะฝะพะต ะผะตััะพ
df -h
```

### ะะพัะปะต ะพะฑะฝะพะฒะปะตะฝะธั ะฑะพั ะฝะต ัะฐะฑะพัะฐะตั

```bash
# ะกะผะพััะธะผ ะปะพะณะธ
ssh root@YOUR_SERVER_IP 'journalctl -u neurocards-bot -n 50'

# ะัะพะฒะตััะตะผ ััะฐััั
ssh root@YOUR_SERVER_IP 'systemctl status neurocards-bot'

# ะะตัะตะทะฐะฟััะบะฐะตะผ
ssh root@YOUR_SERVER_IP 'systemctl restart neurocards-bot'
```

---

## ๐ก ะะพะปะตะทะฝัะต ัะพะฒะตัั

1. **ะกะพััะฐะฝะธ IP ะฐะดัะตั** - ะดะพะฑะฐะฒั alias ะฒ `~/.ssh/config`:
```bash
Host neurocards
    HostName YOUR_SERVER_IP
    User root
    IdentityFile ~/.ssh/id_rsa
```

ะขะตะฟะตัั ะผะพะถะฝะพ:
```bash
./scripts/monitor_vps.sh neurocards
```

2. **ะะฒัะพะผะฐัะธะทะธััะน ะฑัะบะฐะฟั** - ะดะพะฑะฐะฒั ะฒ crontab ะฝะฐ ะปะพะบะฐะปัะฝะพะน ะผะฐัะธะฝะต:
```bash
# ะะฐะถะดะพะต ะฒะพัะบัะตัะตะฝัะต ะฒ 3:00
0 3 * * 0 /path/to/neurocards-bot/scripts/backup_vps.sh 123.45.67.89 /backup/neurocards
```

3. **ะกะปะตะดะธ ะทะฐ ะพะฑะฝะพะฒะปะตะฝะธัะผะธ** - ะฝะฐัััะพะน webhook ะพั GitHub ะดะปั ะฐะฒัะพ-ะดะตะฟะปะพั

---

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั

- [QUICKSTART_VPS.md](../QUICKSTART_VPS.md) - ะฑัััััะน ััะฐัั
- [SELF_HOSTING.md](../SELF_HOSTING.md) - ะฟะพะปะฝะฐั ะธะฝััััะบัะธั
- [PARALLEL_WORKERS.md](../PARALLEL_WORKERS.md) - ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต

---

**ะะพะฟัะพัั? ะกะพะทะดะฐะฒะฐะน Issue ะฝะฐ GitHub!** ๐
